<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Omniverse Marketplace ‚Äî AI & Tips</title>
<link rel="icon" href="assets/favicon.ico">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
<style>
body{margin:0;font-family:Arial,sans-serif;background:#0b1220;color:#e6eef8}
header{padding:12px;background:#081425;display:flex;align-items:center;justify-content:space-between}
header h1{margin:0;font-size:1.3rem}
header button{padding:6px 10px;border:none;border-radius:6px;background:#152040;color:#e6eef8;cursor:pointer}
.container{display:flex;height:calc(100vh - 50px)}
.sidebar{width:260px;background:#0a1020;border-right:1px solid rgba(255,255,255,0.05);overflow-y:auto;padding:12px}
.sidebar button{width:100%;margin-bottom:4px;padding:6px;border:none;border-radius:6px;background:#081425;color:#e6eef8;cursor:pointer;text-align:left;font-size:0.85rem}
.sidebar button.active{background:#152040}
.main{flex:1;padding:12px;overflow-y:auto}
.tool-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;flex-wrap:wrap}
textarea#tool-output{width:100%;height:300px;background:#081425;color:#e6eef8;border:1px solid rgba(255,255,255,0.1);padding:8px;border-radius:6px;resize:none;font-family:monospace}
button.action{padding:6px 10px;margin-right:6px;border:none;border-radius:6px;background:#152040;color:#e6eef8;cursor:pointer;margin-top:4px}
input,textarea{background:#081425;color:#e6eef8;border:1px solid rgba(255,255,255,0.05);border-radius:6px;padding:6px;width:100%;margin-bottom:6px}
.modal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);display:none;justify-content:center;align-items:center;z-index:999}
.modal-content{background:#0b1220;padding:18px;border-radius:10px;width:90%;max-width:600px;max-height:90%;overflow:auto}
.modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
.modal-header h3{margin:0}
.close-btn{cursor:pointer;color:#e6eef8}
a{color:#4fa3ff;text-decoration:none}
a:hover{text-decoration:underline}
</style>
</head>
<body>

<header>
<h1>Omniverse Marketplace ‚Äî AI & Tips</h1>
<button onclick="openSettings()">Owner Settings <i class="fa fa-cog"></i></button>
</header>

<div class="container">
  <div class="sidebar" id="tool-list"></div>
  <div class="main">
    <div class="tool-header">
      <h2 id="tool-title">‡§ï‡•É‡§™‡§Ø‡§æ ‡§¨‡§æ‡§è‡§Å ‡§∏‡•á ‡§è‡§ï tool ‡§ö‡•Å‡§®‡•á‡§Ç‡•§</h2>
      <div>
        <button class="action" onclick="runTool()">Run</button>
        <button class="action" onclick="downloadOutput()">Download</button>
        <button class="action" onclick="copyOutput()">Copy</button>
        <button class="action" onclick="cloneTool()">Clone Tool</button>
      </div>
    </div>
    <textarea id="tool-output" placeholder="Output will appear here..."></textarea>
    <div id="tips-links"></div>
  </div>
</div>

<div class="modal" id="owner-modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3>Owner Settings</h3>
      <span class="close-btn" onclick="closeSettings()">&times;</span>
    </div>
    <label>Owner Name</label>
    <input type="text" id="owner-name" placeholder="‡§Ü‡§™‡§ï‡§æ ‡§®‡§æ‡§Æ">
    <label>Pay / Donate Links (comma separated)</label>
    <textarea id="owner-links" placeholder="upi:abc@paytm, https://paypal.me/you"></textarea>
    <label>OpenAI API Key (optional)</label>
    <input type="text" id="omniverse-openai-key" placeholder="sk-xxxx">
    <button class="action" onclick="saveOpenAIKey()">Save API Key</button>
    <button class="action" onclick="saveOwnerSettings()">Save Owner Settings</button>
    <button class="action" onclick="exportOwnerSettings()">Export Settings</button>
    <button class="action" onclick="importOwnerSettings()">Import Settings</button>
    <hr>
    <button class="action" onclick="addTool()">+ Add Tool</button>
    <button class="action" onclick="resetTools()">Reset All Tools</button>
  </div>
</div>

<script>
// =========================
// LocalStorage + Tools Init
// =========================
const LS_KEY = 'omniverse_tools_v1';
let tools = JSON.parse(localStorage.getItem(LS_KEY) || '[]');

if (tools.length === 0) {
  tools = [];
  for (let i = 1; i <= 100; i++) {
    tools.push({
      name: `Tool ${i}`,
      generatorPrompt: `Generate content for Tool ${i}`
    });
  }
  localStorage.setItem(LS_KEY, JSON.stringify(tools));
}

// =========================
// Render Sidebar
// =========================
function renderToolList() {
  const container = document.getElementById('tool-list');
  container.innerHTML = '';
  tools.forEach((t, i) => {
    const btn = document.createElement('button');
    btn.textContent = t.name;      // Proper name display
    btn.id = 'tool-btn-' + i;
    btn.onclick = () => selectTool(i);
    container.appendChild(btn);
  });
}

// =========================
// Owner Settings
// =========================
function openSettings(){ document.getElementById('owner-modal').style.display='flex'; loadOwnerSettings(); }
function closeSettings(){ document.getElementById('owner-modal').style.display='none'; }
function loadOwnerSettings(){
  document.getElementById('owner-name').value = localStorage.getItem('omniverse_owner_name') || '';
  document.getElementById('owner-links').value = localStorage.getItem('omniverse_owner_links_raw') || '';
  document.getElementById('omniverse-openai-key').value = localStorage.getItem('omniverse_openai_key') || '';
}
function saveOwnerSettings(){
  const name = document.getElementById('owner-name').value.trim();
  const links = document.getElementById('owner-links').value.split(',').map(s=>s.trim()).filter(s=>s);
  localStorage.setItem('omniverse_owner_name', name);
  localStorage.setItem('omniverse_owner_links', JSON.stringify(links));
  localStorage.setItem('omniverse_owner_links_raw', document.getElementById('owner-links').value);
  alert('Owner settings saved.');
  renderTips();
}
function saveOpenAIKey(){
  const key = document.getElementById('omniverse-openai-key').value.trim();
  localStorage.setItem('omniverse_openai_key', key);
  alert('OpenAI API key saved.');
}
function exportOwnerSettings(){
  const data = {
    name: document.getElementById('owner-name').value,
    links: document.getElementById('owner-links').value,
    openai_key: document.getElementById('omniverse-openai-key').value,
    tools: tools
  };
  const blob = new Blob([JSON.stringify(data,null,2)],{type:'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a'); a.href=url; a.download='omniverse_settings.json'; a.click(); URL.revokeObjectURL(url);
}
function importOwnerSettings(){
  const input=document.createElement('input'); input.type='file'; input.accept='.json';
  input.onchange=async function(){
    const file=this.files[0];
    const text=await file.text();
    try{
      const data=JSON.parse(text);
      document.getElementById('owner-name').value = data.name || '';
      document.getElementById('owner-links').value = data.links || '';
      document.getElementById('omniverse-openai-key').value = data.openai_key || '';
      localStorage.setItem('omniverse_owner_links', JSON.stringify(data.links.split(',').map(s=>s.trim()).filter(s=>s)));
      localStorage.setItem('omniverse_owner_links_raw', data.links);
      localStorage.setItem('omniverse_openai_key', data.openai_key || '');
      resetTools();
      if(data.tools) data.tools.forEach(t=>addTool(t.name));
      alert('Settings imported successfully.');
    }catch(e){ alert('Invalid JSON file'); }
  };
  input.click();
}

// =========================
// Tools Functions
// =========================
function saveTools(){ localStorage.setItem(LS_KEY, JSON.stringify(tools)) }
let selectedIndex=null;

function addTool(){
  const name = prompt('Enter new tool name:');
  if(!name) return;
  tools.push({name:name, generatorPrompt:`Generate content for ${name}`});
  saveTools();
  renderToolList();
}
function resetTools(){ if(confirm('Reset all tools?')){ tools=[]; saveTools(); renderToolList(); document.getElementById('tool-output').value=''; } }
function selectTool(i){
  selectedIndex=i;
  document.querySelectorAll('.sidebar button').forEach(b=>b.classList.remove('active'));
  document.getElementById('tool-btn-'+i).classList.add('active');
  document.getElementById('tool-title').textContent=tools[i].name;
  document.getElementById('tool-output').value='';
  renderTips();
}
function cloneTool(){
  if(selectedIndex===null) return alert('Select a tool to clone');
  const original = tools[selectedIndex];
  const cloneName = prompt('Enter name for cloned tool:', original.name + ' Copy');
  if(!cloneName) return;
  tools.push({name:cloneName, generatorPrompt:original.generatorPrompt});
  saveTools();
  renderToolList();
}

// =========================
// Run / AI Output
// =========================
async function runTool(){
  if(selectedIndex===null) return alert('Select a tool first.');
  const tool = tools[selectedIndex];
  const textarea = document.getElementById('tool-output');
  textarea.value = "Generating AI output...";

  const prompt = tool.generatorPrompt || `Generate content for ${tool.name}`;
  const apiKey = localStorage.getItem('omniverse_openai_key');
  if(!apiKey) return textarea.value="Add OpenAI API key in Owner Settings to run AI.";

  try{
    const response = await fetch("https://api.openai.com/v1/completions",{
      method:"POST",
      headers:{
        "Content-Type":"application/json",
        "Authorization":`Bearer ${apiKey}`
      },
      body: JSON.stringify({
        model: "text-davinci-003",
        prompt: prompt,
        max_tokens: 250
      })
    });
    const data = await response.json();
    textarea.value = data.choices[0].text.trim();
  }catch(e){
    textarea.value = "Error generating AI output: "+e.message;
  }
}

// =========================
// Copy / Download / Tips
// =========================
function downloadOutput(){ 
  const val=document.getElementById('tool-output').value; 
  if(!val) return alert('No output'); 
  const blob=new Blob([val],{type:'text/plain'}); 
  const url=URL.createObjectURL(blob); 
  const a=document.createElement('a'); 
  a.href=url; a.download=(selectedIndex!==null?tools[selectedIndex].name:'output')+'.txt'; 
  a.click(); URL.revokeObjectURL(url); 
}
function copyOutput(){
  const val=document.getElementById('tool-output').value;
  if(!val) return alert('No output to copy');
  navigator.clipboard.writeText(val).then(()=>alert('Output copied to clipboard!'));
}
function renderTips(){
  const div=document.getElementById('tips-links');
  const links=JSON.parse(localStorage.getItem('omniverse_owner_links')||'[]');
  div.innerHTML='';
  if(links.length>0){
    div.innerHTML='<strong>Support Owner:</strong> ';
    links.forEach(l=>{
      const a=document.createElement('a'); a.href=l; a.target='_blank'; a.style.marginRight='10px';
      a.textContent='üí∞ Tip';
      div.appendChild(a);
    });
  }
}

// =========================
// Initial Render
// =========================
renderToolList();
renderTips();
</script>

</body>
                                                                   </html>
  
